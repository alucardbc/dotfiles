function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

var _path = require('path');

var path = _interopRequireWildcard(_path);

'use babel';

var fixturePath = path.join(__dirname, 'fixtures');
var goodPath = path.join(fixturePath, 'good.py');
var badPath = path.join(fixturePath, 'bad.py');
var errwarnPath = path.join(fixturePath, 'errwarn.py');

describe('The flake8 provider for Linter', function () {
  var lint = require('../lib/main.js').provideLinter().lint;

  beforeEach(function () {
    // Info about this beforeEach() implementation:
    // https://github.com/AtomLinter/Meta/issues/15
    var activationPromise = atom.packages.activatePackage('linter-flake8');

    waitsForPromise(function () {
      return atom.packages.activatePackage('language-python').then(function () {
        return atom.workspace.open(goodPath);
      });
    });

    atom.packages.triggerDeferredActivationHooks();
    waitsForPromise(function () {
      return activationPromise;
    });
  });

  it('should be in the packages list', function () {
    return expect(atom.packages.isPackageLoaded('linter-flake8')).toBe(true);
  });

  it('should be an active package', function () {
    return expect(atom.packages.isPackageActive('linter-flake8')).toBe(true);
  });

  describe('checks bad.py and', function () {
    var editor = null;
    beforeEach(function () {
      waitsForPromise(function () {
        return atom.workspace.open(badPath).then(function (openEditor) {
          editor = openEditor;
        });
      });
    });

    it('finds at least one message', function () {
      return waitsForPromise(function () {
        return lint(editor).then(function (messages) {
          return expect(messages.length).toBeGreaterThan(0);
        });
      });
    });

    it('verifies that message', function () {
      return waitsForPromise(function () {
        return lint(editor).then(function (messages) {
          expect(messages[0].type).toBe('Warning');
          expect(messages[0].html).not.toBeDefined();
          expect(messages[0].text).toBe('F821 â€” undefined name \'asfd\'');
          expect(messages[0].filePath).toBe(badPath);
          expect(messages[0].range).toEqual([[0, 0], [0, 4]]);
        });
      });
    });

    it('checks that the message is an error if flakeErrors is set', function () {
      atom.config.set('linter-flake8.flakeErrors', true);
      waitsForPromise(function () {
        return lint(editor).then(function (messages) {
          return expect(messages[0].type).toBe('Error');
        });
      });
    });
  });

  describe('checks errwarn.py and', function () {
    var editor = null;

    beforeEach(function () {
      waitsForPromise(function () {
        return atom.workspace.open(errwarnPath).then(function (openEditor) {
          editor = openEditor;
        });
      });
    });

    it('finds at least one message', function () {
      return waitsForPromise(function () {
        return lint(editor).then(function (messages) {
          return expect(messages.length).toBeGreaterThan(0);
        });
      });
    });

    it('finds the message is a warning if pycodestyleErrorsToWarnings is set', function () {
      atom.config.set('linter-flake8.pycodestyleErrorsToWarnings', true);
      waitsForPromise(function () {
        return lint(editor).then(function (messages) {
          return expect(messages[0].type).toBe('Warning');
        });
      });
    });

    it("finds the message is an error if pycodestyleErrorsToWarnings isn't set", function () {
      atom.config.set('linter-flake8.pycodestyleErrorsToWarnings', false);
      waitsForPromise(function () {
        return lint(editor).then(function (messages) {
          return expect(messages[0].type).toBe('Error');
        });
      });
    });
  });

  it('finds nothing wrong with a valid file', function () {
    waitsForPromise(function () {
      return atom.workspace.open(goodPath).then(function (editor) {
        return lint(editor).then(function (messages) {
          return expect(messages.length).toBe(0);
        });
      });
    });
  });

  describe('executable path', function () {
    var helpers = require('atom-linter');

    var editor = null;
    var realExec = helpers.exec;
    var execParams = [];
    function fakeExec() {
      for (var _len = arguments.length, parameters = Array(_len), _key = 0; _key < _len; _key++) {
        parameters[_key] = arguments[_key];
      }

      execParams.push(parameters);
      return Promise.resolve('');
    }

    beforeEach(function () {
      atom.project.addPath(fixturePath);

      Object.defineProperty(helpers, 'exec', {
        enumerable: true,
        value: fakeExec
      });

      waitsForPromise(function () {
        return atom.workspace.open(badPath).then(function (openEditor) {
          editor = openEditor;
        });
      });
    });

    afterEach(function () {
      Object.defineProperty(helpers, 'exec', {
        enumerable: true,
        value: realExec
      });
    });

    it('finds executable relative to project', function () {
      atom.config.set('linter-flake8.executablePath', path.join('$PROJECT', 'flake8'));
      waitsForPromise(function () {
        return lint(editor).then(function () {
          return expect(execParams.pop()[0]).toBe(path.join(fixturePath, 'flake8'));
        });
      });
    });

    it('finds executable relative to projects', function () {
      var paths = [path.join('$project', 'null'), path.join('$pRoJeCt', 'flake1'), path.join('$PrOjEcT', 'flake2'), path.join('$PROJECT', 'flake8')].join(';');
      atom.config.set('linter-flake8.executablePath', paths);
      waitsForPromise(function () {
        return lint(editor).then(function () {
          return expect(execParams.pop()[0]).toBe(path.join(fixturePath, 'flake8'));
        });
      });
    });

    it('finds executable using project name', function () {
      atom.config.set('linter-flake8.executablePath', path.join('$PROJECT_NAME', 'flake8'));
      waitsForPromise(function () {
        return lint(editor).then(function () {
          return expect(execParams.pop()[0]).toBe(path.join('fixtures', 'flake8'));
        });
      });
    });

    it('finds executable using project names', function () {
      var paths = [path.join('$project_name', 'null'), path.join('$pRoJeCt_NaMe', 'flake1'), path.join('$PrOjEcT_nAmE', 'flake2'), path.join('$PROJECT_NAME', 'flake8')].join(';');
      var correct = [path.join('fixtures', 'null'), path.join('fixtures', 'flake1'), path.join('fixtures', 'flake2'), path.join('fixtures', 'flake8')].join(';');
      atom.config.set('linter-flake8.executablePath', paths);
      waitsForPromise(function () {
        return lint(editor).then(function () {
          return expect(execParams.pop()[0]).toBe(correct);
        });
      });
    });

    it('normalizes executable path', function () {
      atom.config.set('linter-flake8.executablePath', path.join(fixturePath, '..', 'fixtures', 'flake8'));
      waitsForPromise(function () {
        return lint(editor).then(function () {
          return expect(execParams.pop()[0]).toBe(path.join(fixturePath, 'flake8'));
        });
      });
    });

    it('finds backup executable', function () {
      var flakeNotFound = path.join('$PROJECT', 'flake8_notfound');
      var flakeBackup = path.join(fixturePath, 'flake8_backup');
      atom.config.set('linter-flake8.executablePath', flakeNotFound + ';' + flakeBackup);
      waitsForPromise(function () {
        return lint(editor).then(function () {
          return expect(execParams.pop()[0]).toBe(path.join(fixturePath, 'flake8_backup'));
        });
      });
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2RkZXdleS8uYXRvbS9wYWNrYWdlcy9saW50ZXItZmxha2U4L3NwZWMvbGludGVyLWZsYWtlOC1zcGVjLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O29CQUVzQixNQUFNOztJQUFoQixJQUFJOztBQUZoQixXQUFXLENBQUM7O0FBSVosSUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDckQsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDbkQsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDakQsSUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsWUFBWSxDQUFDLENBQUM7O0FBRXpELFFBQVEsQ0FBQyxnQ0FBZ0MsRUFBRSxZQUFNO0FBQy9DLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDLElBQUksQ0FBQzs7QUFFNUQsWUFBVSxDQUFDLFlBQU07OztBQUdmLFFBQU0saUJBQWlCLEdBQ3JCLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQyxDQUFDOztBQUVqRCxtQkFBZSxDQUFDO2FBQ2QsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUM7ZUFDcEQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO09BQUEsQ0FBQztLQUFBLENBQUMsQ0FBQzs7QUFFcEMsUUFBSSxDQUFDLFFBQVEsQ0FBQyw4QkFBOEIsRUFBRSxDQUFDO0FBQy9DLG1CQUFlLENBQUM7YUFBTSxpQkFBaUI7S0FBQSxDQUFDLENBQUM7R0FDMUMsQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQyxnQ0FB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ZCxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDO2lCQUNoQixNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLGVBQWUsQ0FBQyxDQUFDO1NBQUEsQ0FDMUU7T0FBQSxDQUNGLENBQUM7S0FDSCxDQUFDLENBQUM7R0FDSixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoiL2hvbWUvZGRld2V5Ly5hdG9tL3BhY2thZ2VzL2xpbnRlci1mbGFrZTgvc3BlYy9saW50ZXItZmxha2U4LXNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcblxuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuY29uc3QgZml4dHVyZVBhdGggPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAnZml4dHVyZXMnKTtcbmNvbnN0IGdvb2RQYXRoID0gcGF0aC5qb2luKGZpeHR1cmVQYXRoLCAnZ29vZC5weScpO1xuY29uc3QgYmFkUGF0aCA9IHBhdGguam9pbihmaXh0dXJlUGF0aCwgJ2JhZC5weScpO1xuY29uc3QgZXJyd2FyblBhdGggPSBwYXRoLmpvaW4oZml4dHVyZVBhdGgsICdlcnJ3YXJuLnB5Jyk7XG5cbmRlc2NyaWJlKCdUaGUgZmxha2U4IHByb3ZpZGVyIGZvciBMaW50ZXInLCAoKSA9PiB7XG4gIGNvbnN0IGxpbnQgPSByZXF1aXJlKCcuLi9saWIvbWFpbi5qcycpLnByb3ZpZGVMaW50ZXIoKS5saW50O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIEluZm8gYWJvdXQgdGhpcyBiZWZvcmVFYWNoKCkgaW1wbGVtZW50YXRpb246XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0F0b21MaW50ZXIvTWV0YS9pc3N1ZXMvMTVcbiAgICBjb25zdCBhY3RpdmF0aW9uUHJvbWlzZSA9XG4gICAgICBhdG9tLnBhY2thZ2VzLmFjdGl2YXRlUGFja2FnZSgnbGludGVyLWZsYWtlOCcpO1xuXG4gICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICBhdG9tLnBhY2thZ2VzLmFjdGl2YXRlUGFja2FnZSgnbGFuZ3VhZ2UtcHl0aG9uJykudGhlbigoKSA9PlxuICAgICAgICBhdG9tLndvcmtzcGFjZS5vcGVuKGdvb2RQYXRoKSkpO1xuXG4gICAgYXRvbS5wYWNrYWdlcy50cmlnZ2VyRGVmZXJyZWRBY3RpdmF0aW9uSG9va3MoKTtcbiAgICB3YWl0c0ZvclByb21pc2UoKCkgPT4gYWN0aXZhdGlvblByb21pc2UpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGJlIGluIHRoZSBwYWNrYWdlcyBsaXN0JywgKCkgPT5cbiAgICBleHBlY3QoYXRvbS5wYWNrYWdlcy5pc1BhY2thZ2VMb2FkZWQoJ2xpbnRlci1mbGFrZTgnKSkudG9CZSh0cnVlKSxcbiAgKTtcblxuICBpdCgnc2hvdWxkIGJlIGFuIGFjdGl2ZSBwYWNrYWdlJywgKCkgPT5cbiAgICBleHBlY3QoYXRvbS5wYWNrYWdlcy5pc1BhY2thZ2VBY3RpdmUoJ2xpbnRlci1mbGFrZTgnKSkudG9CZSh0cnVlKSxcbiAgKTtcblxuICBkZXNjcmliZSgnY2hlY2tzIGJhZC5weSBhbmQnLCAoKSA9PiB7XG4gICAgbGV0IGVkaXRvciA9IG51bGw7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICB3YWl0c0ZvclByb21pc2UoKCkgPT5cbiAgICAgICAgYXRvbS53b3Jrc3BhY2Uub3BlbihiYWRQYXRoKS50aGVuKChvcGVuRWRpdG9yKSA9PiB7IGVkaXRvciA9IG9wZW5FZGl0b3I7IH0pLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaW5kcyBhdCBsZWFzdCBvbmUgbWVzc2FnZScsICgpID0+XG4gICAgICB3YWl0c0ZvclByb21pc2UoKCkgPT5cbiAgICAgICAgbGludChlZGl0b3IpLnRoZW4obWVzc2FnZXMgPT5cbiAgICAgICAgICBleHBlY3QobWVzc2FnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCksXG4gICAgICAgICksXG4gICAgICApLFxuICAgICk7XG5cbiAgICBpdCgndmVyaWZpZXMgdGhhdCBtZXNzYWdlJywgKCkgPT5cbiAgICAgIHdhaXRzRm9yUHJvbWlzZSgoKSA9PlxuICAgICAgICBsaW50KGVkaXRvcikudGhlbigobWVzc2FnZXMpID0+IHtcbiAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0udHlwZSkudG9CZSgnV2FybmluZycpO1xuICAgICAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5odG1sKS5ub3QudG9CZURlZmluZWQoKTtcbiAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0udGV4dCkudG9CZSgnRjgyMSDigJQgdW5kZWZpbmVkIG5hbWUgXFwnYXNmZFxcJycpO1xuICAgICAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5maWxlUGF0aCkudG9CZShiYWRQYXRoKTtcbiAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0ucmFuZ2UpLnRvRXF1YWwoW1swLCAwXSwgWzAsIDRdXSk7XG4gICAgICAgIH0pLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgaXQoJ2NoZWNrcyB0aGF0IHRoZSBtZXNzYWdlIGlzIGFuIGVycm9yIGlmIGZsYWtlRXJyb3JzIGlzIHNldCcsICgpID0+IHtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5mbGFrZUVycm9ycycsIHRydWUpO1xuICAgICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICAgIGxpbnQoZWRpdG9yKS50aGVuKG1lc3NhZ2VzID0+XG4gICAgICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnR5cGUpLnRvQmUoJ0Vycm9yJyksXG4gICAgICAgICksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY2hlY2tzIGVycndhcm4ucHkgYW5kJywgKCkgPT4ge1xuICAgIGxldCBlZGl0b3IgPSBudWxsO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICB3YWl0c0ZvclByb21pc2UoKCkgPT5cbiAgICAgICAgYXRvbS53b3Jrc3BhY2Uub3BlbihlcnJ3YXJuUGF0aCkudGhlbigob3BlbkVkaXRvcikgPT4geyBlZGl0b3IgPSBvcGVuRWRpdG9yOyB9KSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgYXQgbGVhc3Qgb25lIG1lc3NhZ2UnLCAoKSA9PlxuICAgICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICAgIGxpbnQoZWRpdG9yKS50aGVuKG1lc3NhZ2VzID0+XG4gICAgICAgICAgZXhwZWN0KG1lc3NhZ2VzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApLFxuICAgICAgICApLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgaXQoJ2ZpbmRzIHRoZSBtZXNzYWdlIGlzIGEgd2FybmluZyBpZiBweWNvZGVzdHlsZUVycm9yc1RvV2FybmluZ3MgaXMgc2V0JywgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LnB5Y29kZXN0eWxlRXJyb3JzVG9XYXJuaW5ncycsIHRydWUpO1xuICAgICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICAgIGxpbnQoZWRpdG9yKS50aGVuKG1lc3NhZ2VzID0+XG4gICAgICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnR5cGUpLnRvQmUoJ1dhcm5pbmcnKSxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdChcImZpbmRzIHRoZSBtZXNzYWdlIGlzIGFuIGVycm9yIGlmIHB5Y29kZXN0eWxlRXJyb3JzVG9XYXJuaW5ncyBpc24ndCBzZXRcIiwgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LnB5Y29kZXN0eWxlRXJyb3JzVG9XYXJuaW5ncycsIGZhbHNlKTtcbiAgICAgIHdhaXRzRm9yUHJvbWlzZSgoKSA9PlxuICAgICAgICBsaW50KGVkaXRvcikudGhlbihtZXNzYWdlcyA9PlxuICAgICAgICAgIGV4cGVjdChtZXNzYWdlc1swXS50eXBlKS50b0JlKCdFcnJvcicpLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ2ZpbmRzIG5vdGhpbmcgd3Jvbmcgd2l0aCBhIHZhbGlkIGZpbGUnLCAoKSA9PiB7XG4gICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICBhdG9tLndvcmtzcGFjZS5vcGVuKGdvb2RQYXRoKS50aGVuKGVkaXRvciA9PlxuICAgICAgICBsaW50KGVkaXRvcikudGhlbihtZXNzYWdlcyA9PlxuICAgICAgICAgIGV4cGVjdChtZXNzYWdlcy5sZW5ndGgpLnRvQmUoMCksXG4gICAgICAgICksXG4gICAgICApLFxuICAgICk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdleGVjdXRhYmxlIHBhdGgnLCAoKSA9PiB7XG4gICAgY29uc3QgaGVscGVycyA9IHJlcXVpcmUoJ2F0b20tbGludGVyJyk7XG5cbiAgICBsZXQgZWRpdG9yID0gbnVsbDtcbiAgICBjb25zdCByZWFsRXhlYyA9IGhlbHBlcnMuZXhlYztcbiAgICBjb25zdCBleGVjUGFyYW1zID0gW107XG4gICAgZnVuY3Rpb24gZmFrZUV4ZWMoLi4ucGFyYW1ldGVycykge1xuICAgICAgZXhlY1BhcmFtcy5wdXNoKHBhcmFtZXRlcnMpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgnJyk7XG4gICAgfVxuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBhdG9tLnByb2plY3QuYWRkUGF0aChmaXh0dXJlUGF0aCk7XG5cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShoZWxwZXJzLCAnZXhlYycsIHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IGZha2VFeGVjLFxuICAgICAgfSk7XG5cbiAgICAgIHdhaXRzRm9yUHJvbWlzZSgoKSA9PlxuICAgICAgICBhdG9tLndvcmtzcGFjZS5vcGVuKGJhZFBhdGgpLnRoZW4oKG9wZW5FZGl0b3IpID0+IHsgZWRpdG9yID0gb3BlbkVkaXRvcjsgfSksXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShoZWxwZXJzLCAnZXhlYycsIHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IHJlYWxFeGVjLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgZXhlY3V0YWJsZSByZWxhdGl2ZSB0byBwcm9qZWN0JywgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LmV4ZWN1dGFibGVQYXRoJyxcbiAgICAgICAgcGF0aC5qb2luKCckUFJPSkVDVCcsICdmbGFrZTgnKSxcbiAgICAgICk7XG4gICAgICB3YWl0c0ZvclByb21pc2UoKCkgPT5cbiAgICAgICAgbGludChlZGl0b3IpLnRoZW4oKCkgPT5cbiAgICAgICAgICBleHBlY3QoZXhlY1BhcmFtcy5wb3AoKVswXSkudG9CZShwYXRoLmpvaW4oZml4dHVyZVBhdGgsICdmbGFrZTgnKSksXG4gICAgICAgICksXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbmRzIGV4ZWN1dGFibGUgcmVsYXRpdmUgdG8gcHJvamVjdHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwYXRocyA9IFtcbiAgICAgICAgcGF0aC5qb2luKCckcHJvamVjdCcsICdudWxsJyksXG4gICAgICAgIHBhdGguam9pbignJHBSb0plQ3QnLCAnZmxha2UxJyksXG4gICAgICAgIHBhdGguam9pbignJFByT2pFY1QnLCAnZmxha2UyJyksXG4gICAgICAgIHBhdGguam9pbignJFBST0pFQ1QnLCAnZmxha2U4JyksXG4gICAgICBdLmpvaW4oJzsnKTtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5leGVjdXRhYmxlUGF0aCcsIHBhdGhzKTtcbiAgICAgIHdhaXRzRm9yUHJvbWlzZSgoKSA9PlxuICAgICAgICBsaW50KGVkaXRvcikudGhlbigoKSA9PlxuICAgICAgICAgIGV4cGVjdChleGVjUGFyYW1zLnBvcCgpWzBdKS50b0JlKHBhdGguam9pbihmaXh0dXJlUGF0aCwgJ2ZsYWtlOCcpKSxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgZXhlY3V0YWJsZSB1c2luZyBwcm9qZWN0IG5hbWUnLCAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZXhlY3V0YWJsZVBhdGgnLFxuICAgICAgICBwYXRoLmpvaW4oJyRQUk9KRUNUX05BTUUnLCAnZmxha2U4JyksXG4gICAgICApO1xuICAgICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICAgIGxpbnQoZWRpdG9yKS50aGVuKCgpID0+XG4gICAgICAgICAgZXhwZWN0KGV4ZWNQYXJhbXMucG9wKClbMF0pLnRvQmUocGF0aC5qb2luKCdmaXh0dXJlcycsICdmbGFrZTgnKSksXG4gICAgICAgICksXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbmRzIGV4ZWN1dGFibGUgdXNpbmcgcHJvamVjdCBuYW1lcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHBhdGhzID0gW1xuICAgICAgICBwYXRoLmpvaW4oJyRwcm9qZWN0X25hbWUnLCAnbnVsbCcpLFxuICAgICAgICBwYXRoLmpvaW4oJyRwUm9KZUN0X05hTWUnLCAnZmxha2UxJyksXG4gICAgICAgIHBhdGguam9pbignJFByT2pFY1RfbkFtRScsICdmbGFrZTInKSxcbiAgICAgICAgcGF0aC5qb2luKCckUFJPSkVDVF9OQU1FJywgJ2ZsYWtlOCcpLFxuICAgICAgXS5qb2luKCc7Jyk7XG4gICAgICBjb25zdCBjb3JyZWN0ID0gW1xuICAgICAgICBwYXRoLmpvaW4oJ2ZpeHR1cmVzJywgJ251bGwnKSxcbiAgICAgICAgcGF0aC5qb2luKCdmaXh0dXJlcycsICdmbGFrZTEnKSxcbiAgICAgICAgcGF0aC5qb2luKCdmaXh0dXJlcycsICdmbGFrZTInKSxcbiAgICAgICAgcGF0aC5qb2luKCdmaXh0dXJlcycsICdmbGFrZTgnKSxcbiAgICAgIF0uam9pbignOycpO1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LmV4ZWN1dGFibGVQYXRoJywgcGF0aHMpO1xuICAgICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICAgIGxpbnQoZWRpdG9yKS50aGVuKCgpID0+XG4gICAgICAgICAgZXhwZWN0KGV4ZWNQYXJhbXMucG9wKClbMF0pLnRvQmUoY29ycmVjdCksXG4gICAgICAgICksXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgaXQoJ25vcm1hbGl6ZXMgZXhlY3V0YWJsZSBwYXRoJywgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LmV4ZWN1dGFibGVQYXRoJyxcbiAgICAgICAgcGF0aC5qb2luKGZpeHR1cmVQYXRoLCAnLi4nLCAnZml4dHVyZXMnLCAnZmxha2U4JyksXG4gICAgICApO1xuICAgICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICAgIGxpbnQoZWRpdG9yKS50aGVuKCgpID0+XG4gICAgICAgICAgZXhwZWN0KGV4ZWNQYXJhbXMucG9wKClbMF0pLnRvQmUocGF0aC5qb2luKGZpeHR1cmVQYXRoLCAnZmxha2U4JykpLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaW5kcyBiYWNrdXAgZXhlY3V0YWJsZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGZsYWtlTm90Rm91bmQgPSBwYXRoLmpvaW4oJyRQUk9KRUNUJywgJ2ZsYWtlOF9ub3Rmb3VuZCcpO1xuICAgICAgY29uc3QgZmxha2VCYWNrdXAgPSBwYXRoLmpvaW4oZml4dHVyZVBhdGgsICdmbGFrZThfYmFja3VwJyk7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZXhlY3V0YWJsZVBhdGgnLFxuICAgICAgICBgJHtmbGFrZU5vdEZvdW5kfTske2ZsYWtlQmFja3VwfWAsXG4gICAgICApO1xuICAgICAgd2FpdHNGb3JQcm9taXNlKCgpID0+XG4gICAgICAgIGxpbnQoZWRpdG9yKS50aGVuKCgpID0+XG4gICAgICAgICAgZXhwZWN0KGV4ZWNQYXJhbXMucG9wKClbMF0pLnRvQmUocGF0aC5qb2luKGZpeHR1cmVQYXRoLCAnZmxha2U4X2JhY2t1cCcpKSxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=